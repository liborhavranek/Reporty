{% extends "base.html" %}
{% block title %}{{ project.name }} – Projekt{% endblock %}

{% block content %}
<section class="hero-report full admin-dense project-page">
  <div class="project-wrap">

    {# Lokální override jen pro tuto stránku #}
    <style>
      /* Jediný sloupec sekcí (pod sebou), každá sekce je ŠIROKÁ karta */
      .sections-grid.one-col { grid-template-columns: 1fr !important; gap:16px !important; }

      /* .card-glass.wide má v admin-dense šířku do 1600px – tady ji používáme pro sekce */
      .section-card--wide.card-glass.wide { width:100%; margin-inline:auto; }

      /* Uvnitř sekce: sekvence do více sloupců vedle sebe (responsivně) */
      .seq-grid.cols {
        display:grid;
        gap:12px;
        grid-template-columns: repeat(auto-fill, minmax(340px,1fr));
        align-items: stretch;
      }
    </style>

    {# 1) Hlavní karta projektu #}
    <header class="card-glass wide project-card" aria-labelledby="project-title">
      <div class="project-head">
        <div class="project-meta">
          {% if project.logo_path %}
            <img src="{{ url_for('bp.storage_logos', filename=project.logo_path) }}" alt="" class="project-logo">
          {% else %}
            <div class="project-logo placeholder">{{ project.name[:1] }}</div>
          {% endif %}
          <div>
            <div class="eyebrow">Projekt</div>
            <h1 id="project-title" class="project-title">{{ project.name }}</h1>
            {% if project.description %}
              <p class="project-sub">{{ project.description }}</p>
            {% endif %}
          </div>
        </div>
        <a class="btn btn-ghost" href="{{ url_for('bp.public_projects_list') }}">← Zpět na projekty</a>
      </div>
    </header>

    {# 2) ŠIROKÉ sekce pod sebou, obsah sekvencí vedle sebe #}
    {% if sections %}
      <div class="sections-grid one-col">
        {% for s in sections %}
          <section class="card-glass wide section-card section-card--wide" aria-labelledby="section-{{ s.id }}-title">
            <div class="section-head">
              <h2 id="section-{{ s.id }}-title" class="section-title">{{ s.name }}</h2>
              {% if s.description %}
                <p class="section-desc">{{ s.description }}</p>
              {% endif %}
            </div>

            {% set seqs = children.get(s.id, []) %}
            {% if seqs %}
              <div class="seq-grid cols">
                {% for ch in seqs %}
                  <article class="seq-card">
                    <div>
                      <div class="seq-title ellip" title="{{ ch.name }}">{{ ch.name }}</div>
                      {% if ch.description %}
                        <p class="seq-desc">{{ ch.description }}</p>
                      {% endif %}
                    </div>
                    <a class="btn btn-chip"
                       href="{{ url_for('bp.runs_list', project_id=project.id, suite_id=ch.id) }}">
                      Zobrazit reporty
                    </a>
                  </article>
                {% endfor %}
              </div>
            {% else %}
              <div class="card-empty">Žádné sekvence.</div>
            {% endif %}
          </section>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty">
        <p class="sub">Zatím žádné sekce.</p>
      </div>
    {% endif %}

  </div>
</section>
{% endblock %}
